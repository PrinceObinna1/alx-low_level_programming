More functions, more nested loops and this task has a deadline of 3 days
